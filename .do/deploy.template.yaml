spec:
  name: laracon-example
  services:
    - environment_slug: php
      name: laracon-web
      git:
        branch: main
        deploy_on_push: true
        repo_clone_url: https://github.com/hgonzalez-do/LaraconDemo.git
      build_command: npm install && npm run build
      run_command: |
        php artisan migrate --force
        php artisan config:cache
        php artisan route:cache
        php artisan view:cache
        heroku-php-apache2 public/
      envs:
        - key: APP_NAME
          value: Laracon
        - key: APP_ENV
          value: production
        - key: APP_DEBUG
          value: "false"
        - key: APP_URL
          value: ${APP_URL}
        - key: LOG_CHANNEL
          value: "stack"
        - key: LOG_LEVEL
          value: "debug"
        - key: DB_CONNECTION
          value: "pgsql"
        - key: DB_HOST
          value: ${laracon-pg-db.HOSTNAME}
        - key: DB_PORT
          value: ${laracon-pg-db.PORT}
        - key: DB_DATABASE
          value: ${laracon-pg-db.DATABASE}
        - key: DB_USERNAME
          value: ${laracon-pg-db.USERNAME}
          type: SECRET
        - key: DB_PASSWORD
          value: ${laracon-pg-db.PASSWORD}
          type: SECRET
        - key: REDIS_HOST
          value: ${laracon-valkey-db.HOSTNAME}
        - key: REDIS_PASSWORD
          value: ${laracon-valkey-db.PASSWORD}
        - key: REDIS_PORT
          value: ${laracon-valkey-db.PORT}
  databases:
    - engine: PG
      name: laracon-pg-db
      version: "17"
      production: true
    - engine: VALKEY
      name: laracon-valkey-db
      version: "8"
      production: true
